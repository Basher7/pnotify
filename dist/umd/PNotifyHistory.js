!function(t,e){if("function"==typeof define&&define.amd)define("PNotifyHistory",["exports","PNotify"],e);else if("undefined"!=typeof exports)e(exports,require("./PNotify"));else{var i={};e(i,t.PNotify),t.PNotifyHistory=i}}(this,function(t,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,f=(i=e)&&i.__esModule?i:{default:i};var o,n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(t[o]=i[o])}return t};function r(t){var e,i;i=t,(e=this)._observers={pre:l(),post:l()},e._handlers=l(),e._bind=i._bind,e.options=i,e.root=i.root||e,e.store=e.root.store||i.store,this._state=u(s({_notice:null,_options:{}},f.default.modules.History.defaults),t.data),this._fragment=(this._state,{c:a,m:a,p:a,u:a,d:a}),t.target&&(this._fragment.c(),this._mount(t.target,t.anchor))}function a(){}function u(t,e){for(var i in e)t[i]=e[i];return t}function c(t){this.destroy=a,this.fire("destroy"),!(this.set=this.get=a)!==t&&this._fragment.u(),this._fragment.d(),this._fragment=this._state=null}function l(){return Object.create(null)}function h(t){for(;t&&t.length;)t.shift()()}function _(t,e,i,o,n){for(var s in e)if(i[s]){var r=o[s],f=n[s],a=e[s];if(a)for(var u=0;u<a.length;u+=1){var c=a[u];c.__calling||(c.__calling=!0,c.call(t,r,f),c.__calling=!1)}}}u(u(r.prototype,{initModule:function(t){if(this.set(t),this.get("history")){var e=this.get("_notice");e.get("destroy")&&e.set({destroy:!1})}},beforeOpen:function(){var t=this.get("maxInStack");if(t!==1/0){var e=this.get("_options").stack;if(!1!==e&&f.default.notices&&f.default.notices.length>t){for(var i="top"===e.push,o=[],n=0,s=i?0:f.default.notices.length-1;i?s<f.default.notices.length:0<=s;i?s++:s--)-1!==["opening","open"].indexOf(f.default.notices[s].get("_state"))&&f.default.notices[s].get("stack")===e&&(t<=n?o.push(f.default.notices[s]):n++);for(var r=0;r<o.length;r++)o[r].close(!1)}}}}),{destroy:c,get:function(t){return t?this._state[t]:this._state},fire:function(t,e){var i=t in this._handlers&&this._handlers[t].slice();if(!i)return;for(var o=0;o<i.length;o+=1)i[o].call(this,e)},observe:function(e,i,t){var o=t&&t.defer?this._observers.post:this._observers.pre;(o[e]||(o[e]=[])).push(i),t&&!1===t.init||(i.__calling=!0,i.call(this,this._state[e]),i.__calling=!1);return{cancel:function(){var t=o[e].indexOf(i);~t&&o[e].splice(t,1)}}},on:function(t,e){if("teardown"===t)return this.on("destroy",e);var i=this._handlers[t]||(this._handlers[t]=[]);return i.push(e),{cancel:function(){var t=i.indexOf(e);~t&&i.splice(t,1)}}},set:function(t){if(this._set(u({},t)),this.root._lock)return;this.root._lock=!0,h(this.root._beforecreate),h(this.root._oncreate),h(this.root._aftercreate),this.root._lock=!1},teardown:c,_set:function(t){var e=this._state,i={},o=!1;for(var n in t)this._differs(t[n],e[n])&&(i[n]=o=!0);if(!o)return;this._state=u(u({},e),t),this._recompute(i,this._state),this._bind&&this._bind(i,this._state);this._fragment&&(_(this,this._observers.pre,i,this._state,e),this._fragment.p(i,this._state),_(this,this._observers.post,i,this._state,e))},_mount:function(t,e){this._fragment[this._fragment.i?"i":"m"](t,e||null)},_unmount:function(){this._fragment&&this._fragment.u()},_differs:function(t,e){return t!=t?e==e:t!==e||t&&"object"===(void 0===t?"undefined":n(t))||"function"==typeof t}}),r.prototype._recompute=a,(o=r).key="History",o.defaults={history:!0,maxInStack:1/0},o.init=function(t){return new o({target:document.body})},o.showLast=function(t){if(void 0===t&&(t=f.default.defaultStack),!1!==t){var e="top"===t.push,i=e?0:f.default.notices.length-1,o=void 0;do{if(!(o=f.default.notices[i]))return;i+=e?1:-1}while(o.get("stack")!==t||!o.get("_modules").History.get("history")||"opening"===o.get("_state")||"open"===o.get("_state"));o.open()}},o.showAll=function(t){if(void 0===t&&(t=f.default.defaultStack),!1!==t)for(var e=0;e<f.default.notices.length;e++){var i=f.default.notices[e];!0!==t&&i.get("stack")!==t||!i.get("_modules").History.get("history")||i.open()}},f.default.modules.History=o,t.default=r});
//# sourceMappingURL=PNotifyHistory.js.map